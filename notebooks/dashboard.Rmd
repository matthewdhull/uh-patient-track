---
title: "dashboard"
author: "Matthew Hull"
date: "12/15/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(ggpubr)
bar_color <- rgb(100/255,100/255,225/255,1)
```

```{r}
# ansa_df <- read_delim("../data/ANSA.csv", delim=",")
# dummy data for now
x <- c(1, 2, 3, 4, 2.43, 2.0, 1.0, 0.0, 28, 11, 5, 1)
m <- matrix(x, nrow=4, ncol=3, dimnames=list(c(1:4),c("label", "avg_need", "count_id")))
df <- as.data.frame(m)
```


```{r ANSA, echo=TRUE}
# second axis example: https://www.r-graph-gallery.com/line-chart-dual-Y-axis-ggplot2.html  
# underlying table example using ggpubr: https://www.datanovia.com/en/blog/how-to-create-a-beautiful-plots-in-r-with-summary-statistics-labels/

coeff <- 10 # scaling transform for second axis
ansa_avg_need_plot <- ggplot(df, mapping=aes(x=df$label, y=df$avg_need)) + 
  geom_bar(stat="identity", width=0.1, fill=bar_color) +
  geom_line(aes(y=df$count_id/coeff), size=1.5, color="orange") +
  geom_point(aes(y=df$count_id/coeff), size=3, color="orange") +
  scale_y_continuous(
    name = "Average Need",
    sec.axis = sec_axis(~.*coeff, name="Count Id")
  ) +
  ylab("Average Need") + 
  ggtitle("ANSA - Average of Need") + 
  theme_bw() +
  theme(axis.title.x=element_blank())  

ansa_avg_table <- ggsummarytable(df, x="label", y=c("count_id", "avg_need"), digits = 2,
                                 ggtheme = theme_void())

ggarrange(
  ansa_avg_need_plot, ansa_avg_table, ncol=1, align = "v", heights = c(0.80, 0.20)
)
  
```

